/**
 * OCR 프롬프트 - 기출 문제 텍스트 추출용
 * 원문자 보존 지시사항이 매우 중요하므로 수정 금지
 */

export const EXTRACT_TEXT_PROMPT = `이 이미지는 시험지 문제야. 이미지에 있는 모든 텍스트를 정확하게 추출해줘.

⚠️ 최우선 지시사항 - 원문자 필수 유지:
원문자는 선택지 번호로 사용되는 필수 문자야. 원문자를 일반 숫자나 알파벳으로 변환하거나 제거하면 안 돼.
이미지에 원문자가 보이면 반드시 그대로 추출해줘.

⚠️ 매우 중요한 구분:
- 원문자 알파벳: ⓐ, ⓑ, ⓒ, ⓓ, ⓔ, ⓕ, ⓖ, ⓗ, ⓘ, ⓙ (이것들은 절대 변환하면 안 돼!)
- 원문자 숫자: ㉠, ㉡, ㉢, ㉣, ㉤ (이것들도 절대 변환하면 안 돼!)
- 원문자 숫자(선택지): ①, ②, ③, ④, ⑤, ⑥, ⑦, ⑧, ⑨, ⑩ (이것들도 절대 변환하면 안 돼!)

⚠️ 절대 금지 사항:
- 원문자 알파벳(ⓐ, ⓑ, ⓒ, ⓓ, ⓔ, ⓕ, ⓖ, ⓗ, ⓘ, ⓙ)을 원문자 숫자(㉠, ㉡, ㉢, ㉣, ㉤)로 변환하면 안 돼!
- 원문자 숫자(㉠, ㉡, ㉢, ㉣, ㉤)를 원문자 알파벳(ⓐ, ⓑ, ⓒ, ⓓ, ⓔ, ⓕ, ⓖ, ⓗ, ⓘ, ⓙ)으로 변환하면 안 돼!
- 이미지에 ⓐ가 보이면 반드시 ⓐ로 추출하고, ㉠로 변환하면 안 돼!
- 이미지에 ㉠가 보이면 반드시 ㉠로 추출하고, ⓐ로 변환하면 안 돼!

중요한 지시사항:
1. 원문자는 반드시 그대로 유지해줘. 절대 제거하거나 변환하지 마.
2. 특히 원문자 알파벳과 원문자 숫자는 서로 다른 문자이므로 절대 혼동하거나 변환하면 안 돼!
3. 일반 텍스트는 그대로 추출해줘. 밑줄이나 볼드 등 서식은 무시하고 순수 텍스트만 추출해줘.
4. 수학 수식이나 과학 기호가 있는 경우에만 LaTeX 형식으로 변환해줘.
5. 표나 그림이 있다면 그 구조를 텍스트로 표현해줘.
6. 한글, 영어, 숫자, 기호 등 모든 문자를 빠짐없이 추출해줘.
7. 원본 텍스트를 그대로 보존해줘.
8. 문제 본문(지문, 제시문)을 반드시 포함해야 해.
9. 이미지에 있는 모든 텍스트를 빠짐없이 추출해줘.

출력 형식:
- 문제 번호는 "[문제]" 형식으로 시작해줘.
- 이미지에 보이는 문제 번호는 반드시 그대로 보존해줘.
- 정답과 해설은 추출하지 마. 텍스트만 추출해줘.`;

export const EXTRACT_TEXT_WITH_FORMATTING_PROMPT = `이 이미지는 시험지 문제야. 이미지에 있는 모든 텍스트를 정확하게 추출해줘.

⚠️ 최우선 지시사항 - 원문자 필수 유지:
원문자는 선택지 번호로 사용되는 필수 문자야.

중요한 지시사항:
1. 원문자는 반드시 그대로 유지해줘.
2. **밑줄 서식**: 밑줄이 있는 텍스트는 **텍스트** 형식으로 감싸줘.
3. ***볼드 서식***: 볼드(두꺼운) 텍스트는 ***텍스트*** 형식으로 감싸줘.
4. ##밑줄+볼드 서식##: 밑줄과 볼드가 동시에 적용된 텍스트는 ##텍스트## 형식으로 감싸줘.
5. 표가 있다면 <table>내용</table> 형식으로 감싸줘.
6. 수학 수식이나 과학 기호가 있는 경우에만 LaTeX 형식으로 변환해줘.
7. 한글, 영어, 숫자, 기호 등 모든 문자를 빠짐없이 추출해줘.
8. 문제 본문(지문, 제시문)을 반드시 포함해야 해.

출력 형식:
- 문제 번호는 "[문제]" 형식으로 시작해줘.
- 정답과 해설은 추출하지 마.`;

export const EXTRACT_MULTIPLE_REGIONS_PROMPT = `이 이미지들은 시험지 문제의 여러 부분이야. 모든 이미지에 있는 텍스트를 순서대로 정확하게 추출해줘.

⚠️ 최우선 지시사항 - 원문자 필수 유지:
원문자는 선택지 번호로 사용되는 필수 문자야.

중요한 지시사항:
1. 원문자는 반드시 그대로 유지해줘.
2. 일반 텍스트는 그대로 추출해줘.
3. 수학 수식이나 과학 기호가 있는 경우에만 LaTeX 형식으로 변환해줘.
4. 한글, 영어, 숫자, 기호 등 모든 문자를 빠짐없이 추출해줘.
5. 문제 본문(지문, 제시문)을 반드시 포함해야 해.
6. 여러 이미지가 제공되면, 각 이미지의 내용을 순서대로 이어서 하나의 연속된 텍스트로 만들어줘.

출력 형식:
- 문제 번호는 "[문제]" 형식으로 시작해줘.
- 정답과 해설은 추출하지 마.`;

export const ANSWER_EXPLANATION_PROMPT = (text: string) =>
  `다음은 시험지 문제 텍스트야. 이 텍스트를 분석해서 정답과 해설을 추가해서 완성된 문제 형식으로 작성해줘.

⚠️ 중요 지시사항:
1. 원문자는 절대 변경하지 마.
2. 원본 텍스트의 모든 내용을 그대로 유지해줘.
3. 각 문제 뒤에 [정답]과 [해설]을 추가해줘.
4. 문제 본문(지문, 제시문)을 반드시 포함해줘.

출력 형식:
- [문제]로 시작하는 문제 텍스트는 그대로 유지
- 각 문제 뒤에 [정답] (정답 번호 또는 내용) 형식으로 정답 추가
- [정답] 다음에 [해설] (해설 내용) 형식으로 해설 추가

다음 텍스트를 처리해줘:

${text}`;

export const BATCH_ANSWER_PROMPT = (texts: string[]) => {
  const combined = texts
    .map((t, i) => `--- 문제 ${i + 1} ---\n${t}`)
    .join('\n\n');

  return `다음은 같은 지문을 공유하거나 관련된 여러 시험 문제들이야. 각 문제에 정답과 해설을 추가해줘.

⚠️ 중요 지시사항:
1. 원문자는 절대 변경하지 마.
2. 원본 텍스트의 모든 내용을 그대로 유지해줘.
3. 각 문제의 구분자(--- 문제 N ---)를 반드시 그대로 유지해줘.
4. 각 문제 뒤에 [정답]과 [해설]을 추가해줘.
5. 문제 본문(지문, 제시문)을 반드시 포함해줘.

출력 형식:
- 각 문제는 반드시 "--- 문제 N ---" 구분자로 시작
- 구분자 다음에 원본 문제 텍스트를 그대로 유지
- 각 문제 텍스트 뒤에 [정답]과 [해설]을 추가

다음 문제들을 처리해줘:

${combined}`;
};

export const EXAM_ANALYSIS_PROMPT = (jsonText: string, examName: string) =>
  `너는 영어/국어 시험 분석 전문가야. 다음 JSON 데이터는 "${examName}" 시험지에서 추출한 문제들이야. "${examName}"은(는) 이런 시험이라는 것을 참고해서 종합적으로 분석해줘.

⚠️ 분석 지시사항:
1. 모든 문제를 꼼꼼히 읽고 유형을 분류해줘
2. 각 문제의 난이도를 상/중/하로 판단해줘
3. 킬러문항(고난도 변별력 문항)을 찾아줘
4. 시험 전체의 경향성과 특징을 분석해줘
5. 학습 계획을 구체적으로 제안해줘

⚠️ 출력 형식:
반드시 아래 JSON 형식으로만 응답해줘. JSON 외의 텍스트는 포함하지 마.

{
  "summary": {
    "total_questions": (총 문항 수),
    "overall_difficulty": "(상/중상/중/중하/하)",
    "exam_name": "${examName}",
    "trend_analysis": "(시험의 전체적인 경향성과 특징)"
  },
  "type_classification": [
    {
      "type": "(유형명)",
      "count": (해당 유형 문항 수),
      "question_numbers": [(해당 문항 번호들)],
      "difficulty_avg": "(상/중/하)"
    }
  ],
  "difficulty_distribution": {
    "high": (상 문항 수),
    "mid": (중 문항 수),
    "low": (하 문항 수)
  },
  "killer_questions": [
    {
      "q_number": (문항 번호),
      "type": "(문제 유형)",
      "reason": "(킬러문항인 이유)",
      "strategy": "(풀이 전략)"
    }
  ],
  "study_plan": [
    {
      "priority": (1부터 순서대로),
      "area": "(학습 영역)",
      "content": "(구체적인 학습 방법)",
      "target_types": ["(관련 문제 유형들)"]
    }
  ]
}

분석할 시험지 JSON 데이터:

${jsonText}`;

export const DETECT_QUESTIONS_PROMPT = `이 시험지 이미지를 분석하여 문제들을 찾아주세요.
각 문제에 대해 다음 정보를 제공해주세요:
1. 문제 번호
2. 문제 영역의 좌표 (bounding box: [x1, y1, x2, y2])
3. 문제 내용의 미리보기 텍스트

JSON 형식으로 반환해주세요:
{
  "questions": [
    {
      "number": 1,
      "bbox": [x1, y1, x2, y2],
      "text": "문제 내용 미리보기",
      "type": "객관식/주관식/서술형"
    }
  ]
}`;
